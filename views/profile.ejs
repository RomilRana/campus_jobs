<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <script>
        let requestOptionsFindContactinfo = {
            method: 'GET',
            redirect: 'follow'
        };

        fetch("http://localhost:8080/user/findconatactinfo", requestOptionsFindContactinfo)
            .then(response => response.text())
            .then(result => {
                const resultJSON = JSON.parse(result);
                console.log(resultJSON);
                const element = resultJSON[0];
                let tempContactInfo;
                let tempContactField;
                if (element.contact_info.length <= 0) {
                    tempContactInfo = `<td> Please enter the contact info about the person in question </td>`
                    tempContactField = `<tr>INFO</tr>`;
                } else {
                    tempContactInfo = `
                        <td>${element.contact_info[0].address}</td>
                        <td>${element.contact_info[0].locality}</td>
                        <td>${element.contact_info[0].landmark}</td>
                        <td>${element.contact_info[0].phone_number}</td>
                        <td>${element.contact_info[0].state}</td>
                        <td>${element.contact_info[0].country}</td>
                        <td>${element.contact_info[0].city}</td>
                        <td>${element.contact_info[0].zipcode}</td>
                        `;

                    tempContactField = `
                            <th>address</th>
                            <th>locality</th>
                            <th>landmark</th>
                            <th>phone_number</th>
                            <th>state</th>
                            <th>country</th>
                            <th>city</th>
                            <th>zipcode</th>
                    `;
                }
                let htmlContent = `
                    <table class = "table">
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Status</th>
                            <th>Image</th>
                            ${tempContactField}
                        </tr> 
                `

                htmlContent += `
                    <tr>
                        <td>${element.name}</td>
                        <td>${element.email}</td>
                        <td>${element.role}</td>
                        <td>${element.status}</td>
                        <td><img src="http://localhost:8080/${element.profile_pic}" alt="simple Image" height="100" width="100" /></td>
                        ${tempContactInfo}
                    </tr>
                    `
                htmlContent += `</table>`;

                document.getElementById("nameOfUser").innerHTML = htmlContent;
            })
            .catch(error => console.log('error', error));
    </script>
    <script>
        function pageredirect() {
            location.href = "update_profile";
            console.log("function call");
        }
    </script>
</head>

<body>
    <div>
        <%- include('./navbar') %>
    </div>
    <h1>Profile </h1>
    <div id="nameOfUser">
    </div>
    <div>
        <input type="submit" value="update" onclick="pageredirect()" />
    </div>
</body>

</html>